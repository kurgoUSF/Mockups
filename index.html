<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subgoal Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 15px;
        }

        .header-description {
            color: #666;
            margin-bottom: 10px;
        }

        .header-tips {
            font-style: italic;
            color: #888;
            font-size: 0.9rem;
        }

        .subgoal-creator {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .subgoal-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 15px;
        }

        .subgoal-input:focus {
            outline: none;
            border-color: #4a90e2;
        }

        .add-btn {
            background: #4a90e2;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-btn:hover {
            background: #357abd;
        }

        .subgoal-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #4a90e2;
        }

        .subgoal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .subgoal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            flex-grow: 1;
        }

        .subgoal-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 6px 12px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: #f8f9fa;
        }

        .complete-btn {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        /* Global Session Focus Timeline */
        .global-focus-timeline {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .timeline-header-section {
            margin-bottom: 20px;
        }

        .timeline-header-section h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .timeline-subtitle {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .global-clock-bar {
            display: flex;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 15px;
        }

        .global-segment {
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
            border-right: 1px solid rgba(255,255,255,0.3);
        }

        .global-segment:hover {
            filter: brightness(0.9);
            transform: scaleY(1.05);
        }

        .global-segment:last-child {
            border-right: none;
        }

        .subgoal-1 { 
            background: #4a90e2; 
            flex: 2; /* 30 min + 15 min = 45 min total */
        }
        .subgoal-2 { 
            background: #28a745; 
            flex: 2; /* 30 min + 30 min = 60 min total */
        }
        .mixed-focus { 
            background: linear-gradient(45deg, #4a90e2, #28a745); 
            flex: 1; /* 30 min */
        }
        .unassigned { 
            background: #6c757d; 
            flex: 0.5; /* 15 min */
        }

        .global-timeline-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            font-size: 0.85rem;
        }

        .global-timeline-legend .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .global-timeline-legend .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .global-timeline-legend .legend-color.subgoal-1 { background: #4a90e2; }
        .global-timeline-legend .legend-color.subgoal-2 { background: #28a745; }
        .global-timeline-legend .legend-color.mixed-focus { background: linear-gradient(45deg, #4a90e2, #28a745); }
        /* Feature 1: Progress Metrics */
        .progress-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-chip {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 8px 16px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .metric-value {
            font-weight: 600;
            font-size: 1.1rem;
            color: #495057;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 2px;
        }

        .confidence-high { border-color: #28a745; background: #d4edda; }
        .confidence-medium { border-color: #ffc107; background: #fff3cd; }
        .confidence-low { border-color: #dc3545; background: #f8d7da; }

        /* Feature 2: Session Focus Heatmap */
        .focus-heatmap {
            margin: 20px 0;
        }

        .heatmap-label {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }

        .clock-bar {
            display: flex;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .time-segment {
            flex: 1;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }

        .time-segment:hover {
            filter: brightness(0.9);
        }

        .segment-1 { background: #4a90e2; }
        .segment-2 { background: #28a745; }
        .segment-3 { background: linear-gradient(45deg, #4a90e2, #28a745); }
        .segment-4 { background: #ffc107; }
        .segment-5 { background: #17a2b8; }

        /* Timeline Legend */
        .timeline-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
            font-size: 0.8rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* Feature 3: Key Takeaways */
        .insights-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .insight-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }

        .insight-header {
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .insight-item {
            background: white;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            border-left: 3px solid #4a90e2;
            font-size: 0.9rem;
        }

        .insight-actions {
            margin-top: 8px;
            display: flex;
            gap: 5px;
        }

        .mini-btn {
            padding: 3px 8px;
            font-size: 0.7rem;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }

        /* Feature 4: Activity Timeline */
        .activity-timeline {
            margin: 20px 0;
        }

        .timeline-header {
            font-weight: 600;
            color: #495057;
            margin-bottom: 15px;
        }

        .timeline-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid transparent;
        }

        .timeline-item.high-confidence { border-left-color: #28a745; }
        .timeline-item.medium-confidence { border-left-color: #ffc107; }
        .timeline-item.low-confidence { border-left-color: #dc3545; }

        .timeline-time {
            font-size: 0.8rem;
            color: #6c757d;
            min-width: 60px;
        }

        .timeline-content {
            flex-grow: 1;
        }

        .timeline-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 3px;
        }

        .timeline-desc {
            font-size: 0.8rem;
            color: #6c757d;
        }

        .confidence-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .badge-high { background: #d4edda; color: #155724; }
        .badge-medium { background: #fff3cd; color: #856404; }
        .badge-low { background: #f8d7da; color: #721c24; }

        /* Feature 5: Evidence Sheet */
        .evidence-sheet {
            margin: 20px 0;
        }

        .evidence-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .evidence-table th {
            background: #495057;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .evidence-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
        }

        .evidence-table tr:hover {
            background: #f8f9fa;
        }

        .source-link {
            color: #4a90e2;
            text-decoration: none;
            font-size: 0.8rem;
        }

        .needs-confirmation {
            background: #fff3cd;
        }

        /* Feature 6: Unassigned Drawer */
        .unassigned-drawer {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .drawer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .drawer-title {
            font-weight: 600;
            color: #6c757d;
        }

        .unassigned-item {
            background: white;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            border: 1px solid #dee2e6;
        }

        .item-reason {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 5px;
        }

        .item-actions {
            margin-top: 8px;
            display: flex;
            gap: 5px;
        }

        .expandable {
            cursor: pointer;
        }

        .expandable:hover {
            background: #e9ecef;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }

        .tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Subgoal Manager</h1>
            <div class="header-description">
                Please develop at least 3 subgoals <strong>before you begin using the AI Explorer system</strong>. You can also modify, create, or delete subgoals as you use the system.
            </div>
            <div class="header-tips">
                Remember: good subgoals specify <u>action</u>, <u>information</u>, <u>criteria</u>, and <u>time</u>.
            </div>
        </div>

        <!-- Global Session Focus Timeline -->
        <div class="global-focus-timeline">
            <div class="timeline-header-section">
                <h3>Session Focus Timeline</h3>
                <div class="timeline-subtitle">2.5 hours ‚Ä¢ 9:00 AM - 11:30 AM</div>
            </div>
            <div class="global-clock-bar">
                <div class="global-segment subgoal-1 tooltip" data-tooltip="9:00-9:30 - Understanding osmosis mechanisms"></div>
                <div class="global-segment subgoal-2 tooltip" data-tooltip="9:30-10:00 - Comparing transport mechanisms"></div>
                <div class="global-segment subgoal-1 tooltip" data-tooltip="10:00-10:15 - Back to osmosis concepts"></div>
                <div class="global-segment subgoal-3 tooltip" data-tooltip="10:15-10:45 - Analyzing membrane structure"></div>
                <div class="global-segment subgoal-2 tooltip" data-tooltip="10:45-11:15 - Active transport deep dive"></div>
                <div class="global-segment unassigned tooltip" data-tooltip="11:15-11:30 - General biology reading"></div>
            </div>
            <div class="global-timeline-legend">
                <div class="legend-item">
                    <div class="legend-color subgoal-1"></div>
                    <span>Subgoal 1: Osmosis Mechanisms</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color subgoal-2"></div>
                    <span>Subgoal 2: Transport Comparison</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color subgoal-3"></div>
                    <span>Subgoal 3: Membrane Structure</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color unassigned"></div>
                    <span>Unassigned</span>
                </div>
            </div>
        </div>

        <!-- Subgoal Creator -->
        <div class="subgoal-creator">
            <input type="text" class="subgoal-input" placeholder="Enter a new subgoal...">
            <button class="add-btn">Add Subgoal</button>
        </div>

        <!-- Enhanced Subgoal Card 1 -->
        <div class="subgoal-card">
            <div class="subgoal-header">
                <div class="subgoal-title">Understand the fundamental mechanisms of osmosis in living cells</div>
                <div class="subgoal-actions">
                    <button class="action-btn complete-btn">Completed</button>
                    <button class="action-btn">Edit</button>
                    <button class="action-btn">Delete</button>
                </div>
            </div>

            <!-- Feature 1: Progress Metrics -->
            <div class="progress-metrics">
                <div class="metric-chip confidence-high tooltip" data-tooltip="High confidence in item assignment">
                    <div class="metric-value">0.75h</div>
                    <div class="metric-label">Time Spent</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">23</div>
                    <div class="metric-label">Prompts</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">8</div>
                    <div class="metric-label">Sites Visited</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">5</div>
                    <div class="metric-label">Notes Created</div>
                </div>
                <div class="metric-chip confidence-high">
                    <div class="metric-value">87%</div>
                    <div class="metric-label">Confidence</div>
                </div>
            </div>

            <!-- Feature 2: Session Focus Heatmap -->
            <div class="focus-heatmap">
                <div class="heatmap-label">Session Focus Timeline</div>
                <div class="clock-bar">
                    <div class="time-segment segment-1 tooltip" data-tooltip="9:00-9:15 - Basic osmosis concepts"></div>
                    <div class="time-segment segment-2 tooltip" data-tooltip="9:15-9:30 - Water potential and gradients"></div>
                    <div class="time-segment segment-3 tooltip" data-tooltip="9:30-9:45 - Mixed: cell membrane permeability"></div>
                    <div class="time-segment segment-1 tooltip" data-tooltip="9:45-10:00 - Return to osmosis fundamentals"></div>
                    <div class="time-segment segment-5 tooltip" data-tooltip="10:00-10:15 - Plant cell examples"></div>
                </div>
                <div class="timeline-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4a90e2;"></div>
                        <span>Osmosis Focus</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #28a745;"></div>
                        <span>Transport Mechanisms</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(45deg, #4a90e2, #28a745);"></div>
                        <span>Mixed Topics</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffc107;"></div>
                        <span>General Biology</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #17a2b8;"></div>
                        <span>Applications/Examples</span>
                    </div>
                </div>
            </div>

            <!-- Feature 3: Key Takeaways vs Open Questions -->
            <div class="insights-section">
                <div class="insight-panel">
                    <div class="insight-header">
                        Key Takeaways
                        <span style="color: #28a745;">‚úì</span>
                    </div>
                    <div class="insight-item">
                        Osmosis is the movement of water across a selectively permeable membrane down its concentration gradient
                        <div class="insight-actions">
                            <button class="mini-btn">Promote to Note</button>
                        </div>
                    </div>
                    <div class="insight-item">
                        Water potential determines the direction of water movement in biological systems
                        <div class="insight-actions">
                            <button class="mini-btn">Promote to Note</button>
                        </div>
                    </div>
                </div>
                <div class="insight-panel">
                    <div class="insight-header">
                        Open Questions
                        <span style="color: #ffc107;">?</span>
                    </div>
                    <div class="insight-item">
                        How does osmotic pressure relate to turgor pressure in plant cells?
                        <div class="insight-actions">
                            <button class="mini-btn">Create Subgoal</button>
                            <button class="mini-btn">Mark Resolved</button>
                        </div>
                    </div>
                    <div class="insight-item">
                        What happens to animal cells in hypotonic vs hypertonic solutions?
                        <div class="insight-actions">
                            <button class="mini-btn">Create Subgoal</button>
                            <button class="mini-btn">Mark Resolved</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feature 4: Activity Timeline -->
            <div class="activity-timeline">
                <div class="timeline-header">Recent Activity Timeline</div>
                <div class="timeline-item high-confidence">
                    <div class="timeline-time">9:45 AM</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Prompt: "Explain water potential and its components"</div>
                        <div class="timeline-desc">High semantic match to subgoal, recent activity</div>
                    </div>
                    <div class="confidence-badge badge-high">HIGH</div>
                </div>
                <div class="timeline-item medium-confidence">
                    <div class="timeline-time">9:32 AM</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Visited: khanacademy.org/biology/osmosis-diffusion</div>
                        <div class="timeline-desc">URL title overlap, moderate dwell time</div>
                    </div>
                    <div class="confidence-badge badge-medium">MED</div>
                </div>
                <div class="timeline-item high-confidence">
                    <div class="timeline-time">9:28 AM</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Note Edit: "Osmosis vs Simple Diffusion"</div>
                        <div class="timeline-desc">Direct title match, temporal proximity</div>
                    </div>
                    <div class="confidence-badge badge-high">HIGH</div>
                </div>
            </div>

            <!-- Feature 5: Evidence Sheet -->
            <div class="evidence-sheet">
                <div class="timeline-header">Evidence Sheet</div>
                <table class="evidence-table">
                    <thead>
                        <tr>
                            <th>Question</th>
                            <th>Sources Examined</th>
                            <th>Conclusion</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>What is the difference between osmosis and diffusion?</td>
                            <td>
                                <a href="#" class="source-link">Biology Textbook Ch.7 (15 min)</a><br>
                                <a href="#" class="source-link">Khan Academy Video (12 min)</a>
                            </td>
                            <td>Osmosis specifically involves water movement through membranes; diffusion is broader</td>
                            <td>
                                <button class="mini-btn">Confirmed</button>
                            </td>
                        </tr>
                        <tr class="needs-confirmation">
                            <td>How does tonicity affect cell behavior?</td>
                            <td>
                                <a href="#" class="source-link">Lab Simulation (8 min)</a>
                            </td>
                            <td>Hypotonic solutions cause swelling, hypertonic cause shrinkage</td>
                            <td>
                                <button class="mini-btn" style="background: #fff3cd;">Needs Confirmation</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Enhanced Subgoal Card 2 -->
        <div class="subgoal-card">
            <div class="subgoal-header">
                <div class="subgoal-title">Compare passive and active transport mechanisms across cell membranes</div>
                <div class="subgoal-actions">
                    <button class="action-btn complete-btn">Completed</button>
                    <button class="action-btn">Edit</button>
                    <button class="action-btn">Delete</button>
                </div>
            </div>

            <div class="progress-metrics">
                <div class="metric-chip confidence-medium">
                    <div class="metric-value">1.0h</div>
                    <div class="metric-label">Time Spent</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">15</div>
                    <div class="metric-label">Prompts</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">12</div>
                    <div class="metric-label">Sites Visited</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">3</div>
                    <div class="metric-label">Notes Created</div>
                </div>
                <div class="metric-chip confidence-medium">
                    <div class="metric-value">72%</div>
                    <div class="metric-label">Confidence</div>
                </div>
            </div>

            <div class="focus-heatmap">
                <div class="heatmap-label">Session Focus Timeline</div>
                <div class="clock-bar">
                    <div class="time-segment segment-2"></div>
                    <div class="time-segment segment-4"></div>
                    <div class="time-segment segment-2"></div>
                    <div class="time-segment segment-5"></div>
                </div>
            </div>

            <div class="insights-section">
                <div class="insight-panel">
                    <div class="insight-header">Key Takeaways</div>
                    <div class="insight-item">
                        Passive transport requires no energy and moves with concentration gradients
                        <div class="insight-actions">
                            <button class="mini-btn">Promote to Note</button>
                        </div>
                    </div>
                </div>
                <div class="insight-panel">
                    <div class="insight-header">Open Questions</div>
                    <div class="insight-item">
                        How do carrier proteins differ from channel proteins in facilitated diffusion?
                        <div class="insight-actions">
                            <button class="mini-btn">Create Subgoal</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Subgoal Card 3 -->
        <div class="subgoal-card">
            <div class="subgoal-header">
                <div class="subgoal-title">Analyze cell membrane structure and phospholipid bilayer properties</div>
                <div class="subgoal-actions">
                    <button class="action-btn complete-btn">Completed</button>
                    <button class="action-btn">Edit</button>
                    <button class="action-btn">Delete</button>
                </div>
            </div>

            <div class="progress-metrics">
                <div class="metric-chip confidence-high">
                    <div class="metric-value">0.5h</div>
                    <div class="metric-label">Time Spent</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">8</div>
                    <div class="metric-label">Prompts</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">6</div>
                    <div class="metric-label">Sites Visited</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">2</div>
                    <div class="metric-label">Notes Created</div>
                </div>
                <div class="metric-chip confidence-high">
                    <div class="metric-value">85%</div>
                    <div class="metric-label">Confidence</div>
                </div>
            </div>

            <div class="focus-heatmap">
                <div class="heatmap-label">Session Focus Timeline</div>
                <div class="global-clock-bar">
                    <div class="global-segment subgoal-1 tooltip" data-tooltip="9:00-9:30 - Understanding osmosis mechanisms"></div>
                    <div class="global-segment subgoal-2 tooltip" data-tooltip="9:30-10:00 - Comparing transport mechanisms"></div>
                    <div class="global-segment subgoal-1 tooltip" data-tooltip="10:00-10:15 - Back to osmosis concepts"></div>
                    <div class="global-segment subgoal-3 tooltip" data-tooltip="10:15-10:45 - Analyzing membrane structure"></div>
                    <div class="global-segment subgoal-2 tooltip" data-tooltip="10:45-11:15 - Active transport deep dive"></div>
                    <div class="global-segment unassigned tooltip" data-tooltip="11:15-11:30 - General biology reading"></div>
                </div>
                <div class="global-timeline-legend">
                    <div class="legend-item">
                        <div class="legend-color subgoal-1"></div>
                        <span>Subgoal 1: Osmosis</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color subgoal-2"></div>
                        <span>Subgoal 2: Transport</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color subgoal-3"></div>
                        <span>Subgoal 3: Membrane</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color unassigned"></div>
                        <span>Unassigned</span>
                    </div>
                </div>
            </div>

            <div class="insights-section">
                <div class="insight-panel">
                    <div class="insight-header">Key Takeaways</div>
                    <div class="insight-item">
                        Phospholipid bilayer creates selective permeability through hydrophobic core
                        <div class="insight-actions">
                            <button class="mini-btn">Promote to Note</button>
                        </div>
                    </div>
                </div>
                <div class="insight-panel">
                    <div class="insight-header">Open Questions</div>
                    <div class="insight-item">
                        How do cholesterol molecules affect membrane fluidity?
                        <div class="insight-actions">
                            <button class="mini-btn">Create Subgoal</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feature 6: Unassigned & Cross-linked Drawer -->
        <div class="unassigned-drawer">
            <div class="drawer-header">
                <div class="drawer-title">üîç Unassigned & Cross-linked Items (4)</div>
                <button class="mini-btn expandable">View All</button>
            </div>
            
            <div class="unassigned-item">
                <div><strong>Prompt:</strong> "What factors affect the rate of diffusion?"</div>
                <div class="item-reason">üí° Matches "diffusion" keyword, temporal proximity to both subgoals</div>
                <div class="item-actions">
                    <button class="mini-btn">Attach to Subgoal 1</button>
                    <button class="mini-btn">Attach to Subgoal 2</button>
                    <button class="mini-btn">Dismiss</button>
                </div>
            </div>
            
            <div class="unassigned-item">
                <div><strong>Visit:</strong> biologycorner.com/cell-membrane-transport</div>
                <div class="item-reason">üîó Referenced from Subgoal 2, but also mentions osmotic pressure</div>
                <div class="item-actions">
                    <button class="mini-btn">Cross-link</button>
                    <button class="mini-btn">Reference Only</button>
                    <button class="mini-btn">Dismiss</button>
                </div>
            </div>
        </div>

       <!-- Enhanced Subgoal Card 3 -->
        <div class="subgoal-card">
            <div class="subgoal-header">
                <div class="subgoal-title">Analyze cell membrane structure and phospholipid bilayer properties</div>
                <div class="subgoal-actions">
                    <button class="action-btn complete-btn">Mark Complete</button>
                    <button class="action-btn">Edit</button>
                    <button class="action-btn">Delete</button>
                </div>
            </div>

            <div class="progress-metrics">
                <div class="metric-chip confidence-high">
                    <div class="metric-value">0.5h</div>
                    <div class="metric-label">Time Spent</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">8</div>
                    <div class="metric-label">Prompts</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">6</div>
                    <div class="metric-label">Sites Visited</div>
                </div>
                <div class="metric-chip">
                    <div class="metric-value">2</div>
                    <div class="metric-label">Notes Created</div>
                </div>
                <div class="metric-chip confidence-high">
                    <div class="metric-value">85%</div>
                    <div class="metric-label">Confidence</div>
                </div>
            </div>

            <div class="focus-heatmap">
                <div class="heatmap-label">Session Focus Timeline</div>
                <div class="global-clock-bar">
                    <div class="global-segment subgoal-1 tooltip" data-tooltip="9:00-9:30 - Understanding osmosis mechanisms"></div>
                    <div class="global-segment subgoal-2 tooltip" data-tooltip="9:30-10:00 - Comparing transport mechanisms"></div>
                    <div class="global-segment subgoal-1 tooltip" data-tooltip="10:00-10:15 - Back to osmosis concepts"></div>
                    <div class="global-segment subgoal-3 tooltip" data-tooltip="10:15-10:45 - Analyzing membrane structure"></div>
                    <div class="global-segment subgoal-2 tooltip" data-tooltip="10:45-11:15 - Active transport deep dive"></div>
                    <div class="global-segment unassigned tooltip" data-tooltip="11:15-11:30 - General biology reading"></div>
                </div>
                <div class="global-timeline-legend">
                    <div class="legend-item">
                        <div class="legend-color subgoal-1"></div>
                        <span>Subgoal 1: Osmosis</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color subgoal-2"></div>
                        <span>Subgoal 2: Transport</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color subgoal-3"></div>
                        <span>Subgoal 3: Membrane</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color unassigned"></div>
                        <span>Unassigned</span>
                    </div>
                </div>
            </div>

            <div class="insights-section">
                <div class="insight-panel">
                    <div class="insight-header">Key Takeaways</div>
                    <div class="insight-item">
                        Phospholipid bilayer creates selective permeability through hydrophobic core
                        <div class="insight-actions">
                            <button class="mini-btn">Promote to Note</button>
                        </div>
                    </div>
                </div>
                <div class="insight-panel">
                    <div class="insight-header">Open Questions</div>
                    <div class="insight-item">
                        How do cholesterol molecules affect membrane fluidity?
                        <div class="insight-actions">
                            <button class="mini-btn">Create Subgoal</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feature 4: Activity Timeline -->
            <div class="activity-timeline">
                <div class="timeline-header">Recent Activity Timeline</div>
                <div class="timeline-item high-confidence">
                    <div class="timeline-time">10:30 AM</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Prompt: "Describe phospholipid bilayer structure"</div>
                        <div class="timeline-desc">High semantic match to subgoal, recent activity</div>
                    </div>
                    <div class="confidence-badge badge-high">HIGH</div>
                </div>
                <div class="timeline-item medium-confidence">
                    <div class="timeline-time">10:22 AM</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Visited: biology-online.org/membrane-structure</div>
                        <div class="timeline-desc">URL title overlap, good dwell time</div>
                    </div>
                    <div class="confidence-badge badge-medium">MED</div>
                </div>
            </div>

            <!-- Feature 5: Evidence Sheet -->
            <div class="evidence-sheet">
                <div class="timeline-header">Evidence Sheet</div>
                <table class="evidence-table">
                    <thead>
                        <tr>
                            <th>Question</th>
                            <th>Sources Examined</th>
                            <th>Conclusion</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>What makes cell membranes selectively permeable?</td>
                            <td>
                                <a href="#" class="source-link">Textbook Ch.5 (10 min)</a><br>
                                <a href="#" class="source-link">Animation Video (7 min)</a>
                            </td>
                            <td>Phospholipid arrangement creates hydrophobic barrier</td>
                            <td>
                                <button class="mini-btn">Confirmed</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Add new subgoal section -->
        <div class="subgoal-creator">
            <input type="text" class="subgoal-input" placeholder="Enter a new subgoal...">
            <button class="add-btn">Add Subgoal</button>
        </div>
    </div>

    <script>
        // Interactive elements
        document.querySelectorAll('.time-segment').forEach(segment => {
            segment.addEventListener('click', function() {
                alert('Clicked time segment - would show detailed items for this time window');
            });
        });

        document.querySelectorAll('.mini-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const action = this.textContent;
                console.log(`Action: ${action}`);
            });
        });

        document.querySelectorAll('.confidence-badge').forEach(badge => {
            badge.addEventListener('click', function() {
                alert('Would show "Why here?" explanation with top signals');
            });
        });

        document.querySelector('.expandable').addEventListener('click', function() {
            const drawer = document.querySelector('.unassigned-drawer');
            drawer.style.height = drawer.style.height === 'auto' ? 'auto' : 'auto';
            this.textContent = this.textContent === 'View All' ? 'Collapse' : 'View All';
        });
    </script>
</body>
</html>
